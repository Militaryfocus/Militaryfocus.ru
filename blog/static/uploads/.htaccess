# Защита от выполнения скриптов
<FilesMatch "\.(php|php3|php4|php5|phtml|py|pyc|pyo|exe|sh|bat|cmd|pl|cgi|386|dll|com|torrent|js|app|pif|vbs|wsf|asp|cer|csr|jsp|drv|sys|ade|adp|bas|chm|cpl|crt|csh|fxp|hlp|hta|inf|ins|isp|jse|htaccess|htpasswd|ksh|lnk|mdb|mde|mdt|mdw|msc|msi|msp|mst|ops|pcd|prg|reg|scr|sct|shb|shs|url|vbe|vbs|wsc|wsf|wsh)$">
    Order Allow,Deny
    Deny from all
</FilesMatch>

# Разрешаем только изображения
<FilesMatch "\.(jpg|jpeg|png|gif|webp|svg|ico)$">
    Order Allow,Deny
    Allow from all
</FilesMatch>

# Отключаем выполнение PHP
<IfModule mod_php5.c>
    php_flag engine off
</IfModule>
<IfModule mod_php7.c>
    php_flag engine off
</IfModule>

# Заголовки безопасности
<IfModule mod_headers.c>
    Header set X-Content-Type-Options "nosniff"
    Header set X-Frame-Options "SAMEORIGIN"
</IfModule>

# Запрещаем листинг директорий
Options -Indexes

# Ограничение размера файлов (10MB)
LimitRequestBody 10485760